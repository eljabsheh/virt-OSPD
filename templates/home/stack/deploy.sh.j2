#!/bin/bash -x
time openstack overcloud deploy \
--templates templates \
-t 120 \
--control-scale {{ virt_env_ospd_control.vm_count }} \
--compute-scale {{ virt_env_ospd_compute.vm_count }} \
--ceph-storage-scale {{ virt_env_ospd_ceph.vm_count | default(0) }} \
--block-storage-scale {{ virt_env_ospd_block.vm_count | default(0) }} \
--swift-storage-scale {{ virt_env_ospd_swift.vm_count | default(0) }} \
--control-flavor control \
--compute-flavor compute \
--ceph-storage-flavor storage \
--block-storage-flavor storage \
--swift-storage-flavor swift \
--neutron-network-type vxlan \
--neutron-tunnel-types vxlan \
--neutron-vni-ranges 1:10000 \
--neutron-bridge-mappings datacentre:br-bond \
--ntp-server 0.north-america.pool.ntp.org \
--validation-errors-fatal \
--validation-warnings-fatal \
-e templates/overcloud-resource-registry-puppet.yaml \
-e templates/environments/network-isolation.yaml \
-e templates/environments/storage-environment.yaml \
-e templates/environments/net-bond-with-vlans.yaml \
-e YOUR-CUSTOM.YAML
